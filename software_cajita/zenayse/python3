#!/usr/bin/env python3
import time
import board
import adafruit_ads1x15.ads1115 as ADS
from adafruit_ads1x15.analog_in import AnalogIn

i2c = board.I2C()
ads = ADS.ADS1115(i2c)

CANAL_MIC = 1  # ⚠️ Ajusta según tu conexión
mic = AnalogIn(ads, CANAL_MIC)

print("TEST MICRÓFONO - Haz ruido\n")

try:
    while True:
        valor = mic.value
        voltaje = mic.voltage
        
        # Gráfico de barras simple
        nivel = int(valor / 500)
        barra = "█" * min(nivel, 50)
        
        print(f"\rADC: {valor:5d} | V: {voltaje:.3f} | {barra:<50}", end="", flush=True)
        
        time.sleep(0.05)

except KeyboardInterrupt:
    print("\n\nFinalizado")
